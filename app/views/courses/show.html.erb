<% content_for(:head) do %>
    <%= javascript_include_tag 'galleria-1.2.9.min' %>

    <%= stylesheet_link_tag 'gmaps4rails' %>
    <%= javascript_include_tag 'gmaps4rails/gmaps4rails.base' %>
    <%= javascript_include_tag 'gmaps4rails/gmaps4rails.googlemaps' %>

    <%= stylesheet_link_tag 'fullcalendar' %>
    <%= stylesheet_link_tag 'fullcalendar.print', media:'print' %>
<% end %>
<div class="hero-unit">
  <h1><%= @course.title %></h1>

  <p><%= @course.description %>.</p>
</div>
<!--end hero unit -->
<!--
<script>
  if (Galleria) { $("body").text('Galleria works') }
</script>
-->
<div class="row">
  <div class="span10">
    <div id="galleria">
      <% @course.course_assets.each do |m| %>
          <a href="<%= m.asset.asset.url(:medium) %>">
            <img src="<%= m.asset.asset.url(:thumb) %>"
                 data-description="<%= m.asset.description %>"
            >
          </a>
      <% end %>
    </div>
  </div>
</div>
<br/>
<br/>
<div class="row">
  <table class="table table-striped">
    <caption>
      course details
    </caption>
    <tbody>
    <tr>
      <td>Teacher:</td>
      <td><%= @course.teacher_id %></td>
    </tr>
    <tr>
      <td>Number Of Places:</td>
      <td><%= @course.number_of_places %></td>
    </tr>
    <tr>
      <td>Price: €</td>
      <td><%= @course.price %></td>
    </tr>
    <tr>
      <td>Deposit: €</td>
      <td><%= @course.deposit %></td>
    </tr>
    <tr>
      <td>Category:</td>
      <td><%= @course.category.category_name %></td>
    </tr>
    </tbody>
  </table>
  <p><%= link_to 'Enrol', new_enrollment_path(@course.id), class: 'btn btn-large btn-danger' %></a></p>

</div>
<div class="row">
  <%= gmaps('map_options' => {'auto_zoom' => false, 'zoom' => 17}, 'markers' => {'data' => @locations}) %>
</div>
<br/>
<br/>
<div class="row">
  <div id='calendar'></div>
</div>

<% content_for(:foot) do %>
    <!-- add calendar realted js -->
    <%= javascript_include_tag 'fullcalendar.min' %>
    <script type='text/javascript'>
        <% if !@time_table_items.empty? %>
        $(document).ready(function () {

            //change ruby data to javascript data: var date = new Date(date.to_i*1000)
            var start_date = new Date(<%= @time_table_items.first.start_time.to_i * 1000 %>);

            $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek'
                },
                date: start_date.getDate(),
                month: start_date.getMonth(),
                year: start_date.getFullYear(),
                allDaySlot: false,
                defaultView: "agendaWeek",
                theme: false,
                editable: true,
                minTime: 7,
                maxTime: 20,
                events: [
                    <% @time_table_items.each_with_index do |item, index| %>
                    {

                        title: 'All Day Event',
                        start: new Date(<%= item.start_time.to_i * 1000 %>),
                        end: new Date(<%= item.end_time.to_i * 1000%>),
                        title: "Room:<%= item.room %>",
                        allDay: false
                    }<% break if index == @time_table_items.size-1 %>,
                    <% end %>
                ]
            });

        })
        ;
        <%end%>
    </script>
    <!-- add galleria theme js-->
    <script type="text/javascript">
        Galleria.loadTheme('<%= javascript_path 'galleria.classic.min' %>');
        Galleria.run('#galleria');
    </script>

    <!-- add map related js-->
    <%= yield :scripts %>
<% end %>
